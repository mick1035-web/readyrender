# Sentry DSN é©—è­‰æ¸¬è©¦æŒ‡å—

**ç‹€æ…‹ï¼š** âœ… DSN å·²æ·»åŠ ï¼Œé–‹ç™¼ä¼ºæœå™¨å·²é‡å•Ÿ  
**ç›®çš„ï¼š** é©—è­‰ Sentry DSN æ˜¯å¦æ­£ç¢ºé…ç½®ä¸¦èƒ½æ•ç²éŒ¯èª¤

---

## å¿«é€Ÿæ¸¬è©¦æ­¥é©Ÿ

### æ­¥é©Ÿ 1ï¼šæª¢æŸ¥ DSN æ˜¯å¦è¼‰å…¥ âœ…

1. **æ‰“é–‹ç€è¦½å™¨**è¨ªå•ï¼šhttp://localhost:3000

2. **æ‰“é–‹é–‹ç™¼è€…å·¥å…·**ï¼ˆæŒ‰ `F12`ï¼‰

3. **åœ¨ Console ä¸­åŸ·è¡Œ**ä»¥ä¸‹ä»£ç¢¼ï¼š
   ```javascript
   console.log('Sentry DSN:', window.Sentry?.getCurrentHub()?.getClient()?.getOptions()?.dsn);
   ```

4. **é æœŸçµæœï¼š**
   ```
   Sentry DSN: https://[ä½ çš„å…¬é‘°]@o[çµ„ç¹”ID].ingest.sentry.io/[å°ˆæ¡ˆID]
   ```

   âœ… **å¦‚æœçœ‹åˆ°å®Œæ•´çš„ DSN URL** â†’ DSN é…ç½®æˆåŠŸï¼  
   âŒ **å¦‚æœé¡¯ç¤º `undefined`** â†’ DSN æœªè¼‰å…¥ï¼Œéœ€è¦é‡å•Ÿä¼ºæœå™¨

---

### æ­¥é©Ÿ 2ï¼šæ¸¬è©¦é–‹ç™¼æ¨¡å¼éŒ¯èª¤æ•ç² ğŸ”

1. **è§¸ç™¼éŒ¯èª¤**ï¼šåœ¨ç€è¦½å™¨ä¸­è¨ªå•ä¸å­˜åœ¨çš„å°ˆæ¡ˆ
   ```
   http://localhost:3000/editor/test-sentry-123
   ```

2. **è§€å¯ŸéŒ¯èª¤æç¤º**ï¼š
   - âœ… æ‡‰è©²çœ‹åˆ°ç´…è‰²çš„ Toast é€šçŸ¥
   - âœ… æ¨™é¡Œï¼šã€ŒProject Not Foundã€
   - âœ… æè¿°ï¼šã€ŒThis project does not exist...ã€

3. **æª¢æŸ¥ Console**ï¼š
   - æ‰“é–‹é–‹ç™¼è€…å·¥å…· Console
   - æ‡‰è©²çœ‹åˆ°é¡ä¼¼ä»¥ä¸‹çš„æ—¥èªŒï¼š
   ```
   Sentry event (not sent in dev): {
     level: 'error',
     message: 'Project Not Found',
     tags: { errorType: 'PROJECT_NOT_FOUND', severity: 'error' },
     ...
   }
   ```

4. **é æœŸçµæœï¼š**
   - âœ… Console é¡¯ç¤º Sentry äº‹ä»¶
   - âœ… åŒ…å« **"(not sent in dev)"** å­—æ¨£
   - âœ… éŒ¯èª¤è©³æƒ…å®Œæ•´
   - âœ… **æ²’æœ‰ç¶²è·¯è«‹æ±‚**åˆ° sentry.ioï¼ˆé–‹ç™¼æ¨¡å¼ï¼‰

---

### æ­¥é©Ÿ 3ï¼šæ¸¬è©¦ç”Ÿç”¢æ¨¡å¼éŒ¯èª¤è¿½è¹¤ ğŸš€

**é‡è¦ï¼š** é€™æ˜¯çœŸæ­£æ¸¬è©¦ Sentry æ˜¯å¦èƒ½æ¥æ”¶éŒ¯èª¤çš„æ­¥é©Ÿï¼

#### 3.1 æ§‹å»ºç”Ÿç”¢ç‰ˆæœ¬

åœ¨çµ‚ç«¯ä¸­åŸ·è¡Œï¼š

```bash
# åœæ­¢é–‹ç™¼ä¼ºæœå™¨ï¼ˆå¦‚æœæ­£åœ¨é‹è¡Œï¼‰
# æŒ‰ Ctrl+C

# æ§‹å»ºç”Ÿç”¢ç‰ˆæœ¬
npm run build
```

**é æœŸè¼¸å‡ºï¼š**
```
âœ“ Compiled successfully
âœ“ Linting and checking validity of types
âœ“ Collecting page data
âœ“ Generating static pages
âœ“ Finalizing page optimization
```

#### 3.2 å•Ÿå‹•ç”Ÿç”¢ä¼ºæœå™¨

```bash
npm run start
```

**é æœŸè¼¸å‡ºï¼š**
```
â–² Next.js 16.0.10
- Local:        http://localhost:3000
- Network:      http://192.168.x.x:3000

âœ“ Ready in Xms
```

#### 3.3 è§¸ç™¼ç”Ÿç”¢ç’°å¢ƒéŒ¯èª¤

1. **æ‰“é–‹ç€è¦½å™¨**è¨ªå•ï¼šhttp://localhost:3000

2. **ç™»å…¥**æ‚¨çš„å¸³æˆ¶ï¼ˆå¦‚æœéœ€è¦ï¼‰

3. **è§¸ç™¼éŒ¯èª¤**ï¼šè¨ªå•ä¸å­˜åœ¨çš„å°ˆæ¡ˆ
   ```
   http://localhost:3000/editor/production-test-error-456
   ```

4. **è§€å¯Ÿ**ï¼š
   - âœ… æ‡‰è©²çœ‹åˆ°éŒ¯èª¤ Toast é€šçŸ¥
   - âœ… Console ä¸­**ä¸æœƒ**é¡¯ç¤º "not sent in dev"
   - âœ… éŒ¯èª¤**æœƒè¢«ç™¼é€**åˆ° Sentry

#### 3.4 æª¢æŸ¥ Sentry å„€è¡¨æ¿

1. **ç™»å…¥ Sentry**ï¼šhttps://sentry.io

2. **é€²å…¥æ‚¨çš„å°ˆæ¡ˆ**ï¼š
   - é»æ“Šå·¦å´é¸å–®çš„ "Issues"
   - æˆ–ç›´æ¥è¨ªå•ï¼š`https://sentry.io/organizations/[ä½ çš„çµ„ç¹”]/issues/`

3. **æŸ¥æ‰¾æ–°éŒ¯èª¤**ï¼š
   - æ‡‰è©²åœ¨ **5 ç§’å…§**çœ‹åˆ°æ–°çš„éŒ¯èª¤äº‹ä»¶
   - éŒ¯èª¤æ¨™é¡Œï¼šã€ŒProject Not Foundã€
   - é»æ“ŠéŒ¯èª¤æŸ¥çœ‹è©³æƒ…

4. **é©—è­‰éŒ¯èª¤è©³æƒ…**ï¼š
   ```
   âœ… Error Type: PROJECT_NOT_FOUND
   âœ… Severity: error
   âœ… Description: "This project does not exist..."
   âœ… Solutions: 3 å€‹è§£æ±ºæ–¹æ¡ˆ
   âœ… User Context: æ‚¨çš„ email å’Œ IDï¼ˆå¦‚æœå·²ç™»å…¥ï¼‰
   âœ… Stack Trace: å®Œæ•´çš„éŒ¯èª¤å †ç–Š
   âœ… Browser: Chrome/Edge/Firefox ç­‰
   âœ… OS: Windows
   ```

---

## é©—è­‰æ¸…å–®

### é–‹ç™¼æ¨¡å¼ (npm run dev) âœ…
- [ ] DSN åœ¨ Console ä¸­å¯è¦‹
- [ ] éŒ¯èª¤è¢«æ•ç²ä¸¦è¨˜éŒ„
- [ ] Console é¡¯ç¤º "Sentry event (not sent in dev)"
- [ ] æ²’æœ‰ç¶²è·¯è«‹æ±‚åˆ° sentry.io
- [ ] éŒ¯èª¤è¨Šæ¯ç‚ºè‹±æ–‡

### ç”Ÿç”¢æ¨¡å¼ (npm run build && npm run start) ğŸš€
- [ ] æ§‹å»ºæˆåŠŸï¼Œç„¡éŒ¯èª¤
- [ ] ç”Ÿç”¢ä¼ºæœå™¨å•Ÿå‹•æˆåŠŸ
- [ ] éŒ¯èª¤è¢«æ•ç²ä¸¦é¡¯ç¤º Toast
- [ ] éŒ¯èª¤**ç™¼é€**åˆ° Sentryï¼ˆ5ç§’å…§ï¼‰
- [ ] Sentry å„€è¡¨æ¿é¡¯ç¤ºæ–°éŒ¯èª¤
- [ ] éŒ¯èª¤è©³æƒ…å®Œæ•´ï¼ˆé¡å‹ã€æè¿°ã€è§£æ±ºæ–¹æ¡ˆï¼‰
- [ ] ç”¨æˆ¶ä¸Šä¸‹æ–‡æ­£ç¢ºï¼ˆå¦‚æœå·²ç™»å…¥ï¼‰
- [ ] Stack trace å¯è®€

---

## æ•…éšœæ’é™¤

### å•é¡Œ 1ï¼šDSN é¡¯ç¤º undefined

**åŸå› ï¼š** ç’°å¢ƒè®Šæ•¸æœªè¼‰å…¥

**è§£æ±ºæ–¹æ¡ˆï¼š**
```bash
# 1. ç¢ºèª .env.local å­˜åœ¨ä¸”åŒ…å« DSN
# 2. é‡å•Ÿé–‹ç™¼ä¼ºæœå™¨
taskkill /F /IM node.exe
npm run dev
```

### å•é¡Œ 2ï¼šç”Ÿç”¢æ¨¡å¼éŒ¯èª¤æœªå‡ºç¾åœ¨ Sentry

**æª¢æŸ¥æ¸…å–®ï¼š**

1. **ç¢ºèª DSN æ­£ç¢º**
   ```javascript
   // åœ¨ç”Ÿç”¢ç’°å¢ƒçš„ Console ä¸­åŸ·è¡Œ
   console.log(window.Sentry?.getCurrentHub()?.getClient()?.getOptions()?.dsn);
   ```

2. **æª¢æŸ¥ç¶²è·¯è«‹æ±‚**
   - æ‰“é–‹ DevTools â†’ Network æ¨™ç±¤
   - è§¸ç™¼éŒ¯èª¤
   - æŸ¥æ‰¾å° `sentry.io` çš„ POST è«‹æ±‚
   - æ‡‰è©²çœ‹åˆ°ç‹€æ…‹ç¢¼ 200

3. **æª¢æŸ¥ Console éŒ¯èª¤**
   - æŸ¥çœ‹æ˜¯å¦æœ‰ Sentry ç›¸é—œéŒ¯èª¤
   - æŸ¥çœ‹æ˜¯å¦æœ‰ CSP é•è¦

4. **é©—è­‰ç’°å¢ƒ**
   ```javascript
   console.log('NODE_ENV:', process.env.NODE_ENV);
   // ç”Ÿç”¢æ¨¡å¼æ‡‰è©²é¡¯ç¤º: "production"
   ```

### å•é¡Œ 3ï¼šéŒ¯èª¤è¨Šæ¯ä»ç‚ºä¸­æ–‡

**åŸå› ï¼š** æŸäº›è¨Šæ¯æœªæ›´æ–°

**è§£æ±ºæ–¹æ¡ˆï¼š**
- æª¢æŸ¥ `lib/errorMessages.ts`
- ç¢ºèªæ‰€æœ‰è¨Šæ¯å·²ç¿»è­¯ç‚ºè‹±æ–‡
- é‡æ–°æ§‹å»ºï¼š`npm run build`

---

## æˆåŠŸæŒ‡æ¨™

### âœ… é–‹ç™¼æ¨¡å¼æˆåŠŸ
```
âœ“ DSN è¼‰å…¥
âœ“ éŒ¯èª¤æ•ç²
âœ“ Console æ—¥èªŒ
âœ“ ä¸ç™¼é€åˆ° Sentry
```

### âœ… ç”Ÿç”¢æ¨¡å¼æˆåŠŸ
```
âœ“ æ§‹å»ºæˆåŠŸ
âœ“ éŒ¯èª¤æ•ç²
âœ“ ç™¼é€åˆ° Sentry
âœ“ å„€è¡¨æ¿é¡¯ç¤ºéŒ¯èª¤
âœ“ è©³æƒ…å®Œæ•´
```

---

## ä¸‹ä¸€æ­¥

### å¦‚æœæ¸¬è©¦æˆåŠŸ âœ…

1. **è¨­ç½®å‘Šè­¦**
   - åœ¨ Sentry ä¸­é…ç½® Email é€šçŸ¥
   - è¨­ç½® Slack æ•´åˆï¼ˆå¯é¸ï¼‰

2. **ç›£æ§éŒ¯èª¤**
   - å®šæœŸæª¢æŸ¥ Sentry å„€è¡¨æ¿
   - è¿½è¹¤éŒ¯èª¤è¶¨å‹¢
   - å„ªå…ˆä¿®å¾©é«˜é »éŒ¯èª¤

3. **å„ªåŒ–é…ç½®**
   - èª¿æ•´æ¡æ¨£ç‡ï¼ˆå¦‚éœ€è¦ï¼‰
   - é…ç½®éŒ¯èª¤éæ¿¾è¦å‰‡
   - æ·»åŠ è‡ªå®šç¾©æ¨™ç±¤

### å¦‚æœæ¸¬è©¦å¤±æ•— âŒ

1. **æª¢æŸ¥ DSN æ ¼å¼**
   ```env
   # æ­£ç¢ºæ ¼å¼
   NEXT_PUBLIC_SENTRY_DSN=https://abc123@o123456.ingest.sentry.io/7890123
   
   # éŒ¯èª¤æ ¼å¼
   NEXT_PUBLIC_SENTRY_DSN=abc123  # âŒ ç¼ºå°‘ URL
   ```

2. **é‡æ–°é…ç½®**
   - è¨ªå• Sentry å°ˆæ¡ˆè¨­ç½®
   - è¤‡è£½æ–°çš„ DSN
   - æ›´æ–° `.env.local`
   - é‡å•Ÿä¼ºæœå™¨

3. **æŸ¥çœ‹æ—¥èªŒ**
   - æª¢æŸ¥çµ‚ç«¯è¼¸å‡º
   - æª¢æŸ¥ç€è¦½å™¨ Console
   - æŸ¥æ‰¾éŒ¯èª¤è¨Šæ¯

---

## å¿«é€Ÿå‘½ä»¤åƒè€ƒ

```bash
# é–‹ç™¼æ¨¡å¼ï¼ˆéŒ¯èª¤ä¸ç™¼é€ï¼‰
npm run dev

# ç”Ÿç”¢æ§‹å»º
npm run build

# ç”Ÿç”¢æ¨¡å¼ï¼ˆéŒ¯èª¤ç™¼é€åˆ° Sentryï¼‰
npm run start

# åœæ­¢æ‰€æœ‰ Node é€²ç¨‹
taskkill /F /IM node.exe

# æª¢æŸ¥ Sentry å®‰è£
npm list @sentry/nextjs
```

---

## è¯çµ¡æ”¯æ´

å¦‚æœé‡åˆ°å•é¡Œï¼š
- **Sentry æ–‡æª”ï¼š** https://docs.sentry.io/platforms/javascript/guides/nextjs/
- **Sentry æ”¯æ´ï¼š** https://sentry.io/support/
- **Discordï¼š** https://discord.gg/sentry

---

**ç¥æ¸¬è©¦é †åˆ©ï¼** ğŸ‰

å¦‚æœæ‰€æœ‰æ¸¬è©¦é€šéï¼Œæ‚¨çš„ Sentry éŒ¯èª¤è¿½è¹¤ç³»çµ±å°±å®Œå…¨æº–å‚™å¥½äº†ï¼
